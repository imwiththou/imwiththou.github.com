---
title: 關於布豐投針試驗計算pi值的分析以及蒙特卡羅方法在生物分子學上的應用
layout: post
---

昨天晚上看到立叔在人人上轉的一張照片上的題目，閒得沒事就自己動筆算了一下，結果發現題中別有洞天。

 

原題設：平面內間距為D的一組平行線，任意放置一長為\(l(l<D)\)的針。

求證：針與直線相交的概率為 \[P=\frac{2l}{\pi D}\]

 

這道題目看著就很熟悉，至少高中的時候看說過類似的題目，於是就突然想起布豐投針的試驗了。

 
---

解：

1) 首先考慮相交的可能性:

設針的中點與距離其最近的直線的距離為\(x\)，且此針所在的直線與此直線所成的銳角為\(a\);

則有  概率密度

\[\begin{align}
P(0\leq x \leq \frac{D}{2})&=\frac{2}{D}dx;\\
P(0\leq a \lep \frac{\pi}{2}&=\frac{2}{\pi}da)
\end{align}\]


 

由於“\(x\)在\(0\)到\(\frac{D}{2}\)之間”和“\(a\)在\(0\)到\(\frac{\pi}{2}\)之間”互為獨立事件，當且僅當這兩個事件同時發生時，針與直線才有相交的可能性，故

\[P(x,a)=\frac{4}{\pi D}dxda \]


2) 現在討論相交的情況:

很容易發現，當\(x \leq \frac{l\times \sin{a}}{2}\)時，針與直線相交，故

\[\begin{align}
P&=\int\limits_{0}^{\frac{\pi}{2}}\int\limits_{0}^{\frac{\sin{a}}{2}}\frac{4}{\pi D}dxda\\
&=\int\limits_{0}^{\frac{\pi}{2}}\frac{2l\sin{a}}{\pi D}da\\
&=\frac{2l}{\pi D\times 1}\\
\frac{2l}{\pi D}
\end{align}\]
 

得解。

---

 

進一步討論：布豐投針試驗求pi值與蒙特卡羅方法

 蒙特卡羅方法，又稱為不確定性算法或統計模擬法，指以隨機數或偽隨機數來解決計算問題的方法。蒙地卡羅方法基于这样的思想：假想你有一袋豆子，把豆子均匀地朝这个图形上撒，然后数这个图形之中有多少颗豆子，这个豆子的数目就是图形的面积。当你的豆子越小，撒的越多的时候，结果就越精确。借助计算机程序可以生成大量均匀分布坐标点，然后统计出图形内的点数，通过它们占总点数的比例和坐标点生成范围的面积就可以求出图形面积。

在解決問題的過程中，蒙特卡洛方法一般由兩部分組成：第一步，模擬題設過程並產生與表達各種概率分佈的隨機變量（例如上題中的概率密度\(P(0\leq x \leq\frac{D}{2})\)和\(P(0\leq a \leq\frac{\pi}{2})\)，以及最後的\(P(x,a)\); 第二步，用統計方法將模型的數字特徵估計出來從而得到實際解（在上題解法中沒有給出後續的計算，實際上是通過此投針的方法估算出圓周率\(\pi\)的值）。

蒙特卡羅方法在生物分子學和化學以及物理學中都有很廣的應用。比如在生物分子學中，若要通過一個分子的一直構型確立位置分子的某種可能構型，可以依據以下步驟實現：
<pre><code>
1. 使用随机数（偽隨機數）发生器产生一个随机的分子构型。
2. 對此分子構型的其中例子坐標做無規則的改變，產生一個新的分子構型；
3. 計算新的分子構型的能量；
比較新的分子構型於改變遷的分子構型的能量變化，決定是否接受該構：
4. if(新的分子構型能量低於緣分子構型的能量)
	then 接受新的構型並使用這個構型做下一次迭代;

   else if(新的分子構型能量高於原分子構型的能量)
 	then 計算玻爾茲曼因子並產生一個隨機數 {
		if(這個隨機數大於所計算出的玻爾茲曼因子*) 
			then 放棄這個構型，重新計算;
		else (這個隨機數小於所計算出的玻爾茲曼因子，接受這個狗性並使用這個構型重複做下一次迭代;
	} 
5. 如此進行迭代計算直至最後搜索出低於所給能量條件的分子構型
</code></pre>

\*玻爾茲曼因子(Boltzmann's factor)＝\(e^{-\frac{E_{i}}{kT}}\), \(k=\)玻爾茲曼常數(Boltzmann constant)\(＝1.3810^{-23} J/K\)，\(E_{i}＝\)狀態\(i\)的能量

---
最後回到矇特卡羅方法計算\(\pi\)值的試驗中談談相關的流程。

 

讓計算機每次隨機生成兩個0到1之間的數，看以這兩個實數為橫縱坐標的點是否在單位圓內。生成一系列隨機點，統計單位圓內的點數與總點數，（圓面積和正方形面積之比為\(\pi : 4\)），當隨機點取得越多時，其結果越接近於圓周率（然而準確度仍有爭議：即使取\(10^{9}\)個隨機點時，其結果也僅在前4位與圓周率吻合）。實際上，計算機產生的隨機數隻能精確到某位數，並不能產生任意實數（例如無理數等等）；上述做法將平面分割成一個個網格，由此計算出來的面積當然與圓或多或少有差距。