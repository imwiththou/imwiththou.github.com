---
title: 最簡單的多層神經網絡模型構建
layout: post
---

近來大致了解了一下Matlab對於神經網絡的模擬過程，表徵一個神經網絡的關鍵是網絡的激活函數，多餘多層網絡，我們可以將前一層的輸出作為後一層的輸入來實現，一層一層直至網絡輸出。

首先定義以下標識：

P: 輸入矩陣

W: 權矩陣

B: 偏矩陣

A: 網絡輸出矩陣

下面舉個例子來說明一下：一個具有雙曲正切S型即或函數的單層網絡，輸入矢量有四組，每組三個分量；輸出矢量有5個神經元。假定輸入矢量和權矢量均取值為1，計算神經網絡輸出。


代碼如下

<pre><code>%outa.m
Q=4; %number of colunm
R=3; %number of row
S=5; %number of neural node
W=ones(S, R); ％將1 賦值給S\*R 維權矩陣W
B=ones(S, Q); ％將1 賦值給S\*Q 偏差矩陣B
P=ones(R, Q); ％將1 賦值給R\*Q 維輸入矩陣P
n=W*P+B; ％計算加權輸入和
A=tansig(n) %calculate network output %計算神經網絡輸出
</pre></code>

我們把代碼保存為outa.m 並運行，得到以下輸出：

<pre><code>>> outa
A =
    0.9993    0.9993    0.9993    0.9993
    0.9993    0.9993    0.9993    0.9993
    0.9993    0.9993    0.9993    0.9993
    0.9993    0.9993    0.9993    0.9993
    0.9993    0.9993    0.9993    0.9993
</pre></code>

於是一個最簡單的多層神經網絡模型就構建完畢了。